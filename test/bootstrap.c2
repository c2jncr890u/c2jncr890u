(datatype Sexpr
    (Sexpr_term string)
    (Sexpr_list (string list))
)

(fun sexpr_load (fp: string) (returns Sexpr)
    (let 
        (stack (ref (:: nil nil)))
        in
        (map (re.findall "" (file.read fp))
            (fn t
                (if (== t "") (append stack (Sexpr_list []))
                    (if (== t "") (append (getitem stack -2) (pop stack))
                        ( true (.append (getitem stack -1) t) )
                    )
                )
            )
        )
        (assert (== (length stack) 1))
        (pop stack)
    )
)
