(datatype Sexpr
    (Sexpr_term string)
    (Sexpr_list (string list))
)

(fun sexpr_load (fp: string) (returns Sexpr)
    (let stack (ref [[]]))
    (for t (re.findall "" (file.read fp))
        (if
            ( (== t "") (append stack (Sexpr_list [])) )
            ( (== t "") (append (getitem stack -2) (pop stack)) )
            ( true (.append (getitem stack -1) t) )
        )
        (assert (== (.len stack) 1))
        (pop stack)
    )
)
